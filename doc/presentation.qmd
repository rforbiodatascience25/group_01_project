---
title: "Presentation"
author: "Asbj√∏rn, Emiliano, Magnus, Oliver and Trine"
format:
  revealjs:
    theme: simple
    transition: slide
    footer: "Group 01 R for Bio data science 22160"
    highlight-style: github
    code-fold: false
    slide-number: c/t
    show-slide-number: all
output-dir: doc
---

# Introduction

::: {#Introduction style="font-size: 0.8em"}
-   Dataset from GEO-NCBI

-   Ulcerative colitis = ulcers in the colon

    -   Chronic inflammation

-   Scope: Find and analyze variation between gene expression in healthy controls and patients
:::

# Materials and Methods

::::: columns
::: {.column width="50%" style="font-size: 0.8em"}
-   Biopsies from 4 anatomical locations in the gut
    -   202 samples

    -   67 patients with UC

    -   31 healthy control

        -   23 non-inflamed

        -   8 inflamed non-inflammatory bowel disease
-   Augments to the data
    -   Age and Age group
:::

::: {.column width="50%"}
![](images/age_groups_distribution_inflammation_status.png)
:::
:::::

::: {#Source .Reference style="font-size: 0.4em"}
*Noble CL, Abbas AR, Cornelius J, et al Regional variation in gene expression in the healthy colon is dysregulated in ulcerative colitis Gut 2008;**57:**1398-1405.*
:::

## Filtering data

::::: columns
::: {.column width="50%" style="font-size: 0.9em"}
Removing one-type columns

```{r Cleaning_phenodata, echo=TRUE, eval=FALSE}
phenodata <- phenodata |>
  select(
    where(
      ~ n_distinct(
        .x, na.rm = TRUE) > 1))
```

![](images/variance_distribution_across_genes.png)
:::

::: {.column width="50%" style="font-size: 0.9em"}
Removing low variance genes (lower than 0.05) - 37000 of 40000 leaving 10 %

```{r Cleaning_genes, echo=TRUE, eval=FALSE}
gene_var <- exprs_df |> 
  # Drop the sample ID column, keep only expression values
  select(-geo_accession) |> 
  summarise(across(everything(), ~ var(.x, na.rm = TRUE))) |> 
  pivot_longer(
    cols      = everything(),
    names_to  = "gene",
    values_to = "variance"
  )
# Cutoff genes that does not vary more than 0.05 - 2909 genes remaining
genes_keep <- gene_var |> 
  filter(variance > 0.05) |> 
  pull(gene)

exprs_filtered <- exprs_df |> 
  select(geo_accession, all_of(genes_keep))

```
:::
:::::

# Results: Heatmap of top 40 significant genes for inflammation {style="font-size: 0.6em"}

::::: columns
::: {.column width="30%"}
-   Overview of gene expression of significant genes
-   Immune related genes (LCN2 and IGHG1)
-   Non-immune related genes (GCNT2 and UGT2A3)
-   Variance inflammed vs uninflammed
:::

::: {.column width="70%"}
![](images/top40_differential_genes_across_samples.png)
:::
:::::

# Significant genes in anatomic locations {style="font-size: 0.8em"}

::::: columns
::: {.column width="30%"}
-   Significant genes sublocation:
    -   Sigmoid colon
    -   Descending colon
:::

::: {.column width="70%"}
![](images/significant_gene_count_by_anatomic_location.png)
:::
:::::

# Significant genes in UC and inflammation {style="font-size: 0.5em"}

::::: columns
::: {.column width="40%"}
-   Upregulated genes in inflammed (red) vs uninflammed (blue) biopsies
    -   coloured dots: p-value \< 0.05 & log2 fold change above 0.25
-   Random forest model (green): Most contributing genes
-   Inflammation vs UC diagnostics
    -   Little overlay for genes in the 2 analysis

![](images/confusion_matrix_rf.png)
:::

::: {.column width="60%"}
![](images/volcano_plot_colonic_gene_expression_RF-01.png)
:::
:::::

# Discussion:

::: {#Discussion style="font-size: 0.6em"}
-   What causes UC

    -   We investigated if there is a genetic link in getting UC

-   UC caused by various factors

    -   Immune-system issue i.e. an auto immune disease

    -   Gut bacteria imbalance

    -   Genetic traits

    -   Environmental impact

-   What causes inflammation

    -   Key genes in inflammation

    -   Inflammation overshadowing UC diagnosis?

-   Limited sample size (67 patients + 30 controls)

-   An inconsistent data set - Meta data
:::

::: {#Source2 style="font-size: 0.4em"}
<https://www.mayoclinic.org/diseases-conditions/ulcerative-colitis/symptoms-causes/syc-20353326>
:::

# Conclusion

::: {#Conclusion style="font-size: 0.8em"}
We show that there is a correlation between some genes and the inflammation (blue/red dots). The genes that we found to be influencing the development of UC (random forest analysis) do not align with this.
:::
