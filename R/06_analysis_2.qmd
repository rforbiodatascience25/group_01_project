---
title: "06_analysis_2"
format:
  html:
    fig-format: png
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(dev = "png")
```

# Analysis 2

## Loading libraries

```{r}
library("ggrepel")
library("dplyr")
library("tidyverse")
```

## Loading finaldata and featuredata

```{r age_group_distribution_by_inflammation_status}
#| message: false
#| warning: false

finaldata <- read_csv("../data/03_dat_aug.csv.gz")
featuredata <- read_csv("../data/featuredata.csv.gz")
```

```{r age_groups_distribution_inflammation_status}
finaldata |> 
    filter(!is.na(age_group)) |>
    ggplot(mapping = aes(x = age_group, fill = inflammation_status))+
       geom_bar(position = position_dodge2(preserve = "single", padding = 0), 
        color = "black", 
        alpha = 0.4)+
      theme_minimal(base_size = 10) +
      theme(
        legend.position = "bottom"
     ) +
     labs(
       x = "Age groups",
        y = "n",
       fill = "Inflammation-status"
      )
```

```{r gene_expression_by_smoking_status_and_inflammation}
finaldata |>
  filter(!is.na(smoking_status)) |> 
  ggplot(aes(x = smoking_status, y = gene_expr, 
             fill = inflammation_status)) +
  geom_violin(trim = FALSE, alpha = 0.5) +
  geom_boxplot(width = 0.15, outlier.shape = NA, position = position_dodge(width = 0.9)) +
  coord_flip() +
  theme_minimal() +
  labs(x = "Smoking status", y = "Gene expression")
```

```{r}
rm(list = ls())
```
